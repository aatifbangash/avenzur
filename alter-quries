

# Update Product Ledgers to stop accidentail entries:

UPDATE sma_products SET purchase_account = 0, sale_account = 0, inventory_account = 0;

# Add Ledger into Customer table:

ALTER TABLE `sma_companies` ADD `return_ledger` BIGINT NULL DEFAULT NULL AFTER `vat_on_sales_ledger`;


CREATE TABLE `sma_dbs` (
  `id` int(11) NOT NULL,
  `db_name` varchar(255) NOT NULL,
  `db_user` varchar(255) NOT NULL,
  `db_pass` varchar(255) NOT NULL,
  `is_used` tinyint(1) NOT NULL DEFAULT 0,
  `is_primary` tinyint(1) NOT NULL DEFAULT 0
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

ALTER TABLE `sma_dbs`
  ADD PRIMARY KEY (`id`);

ALTER TABLE `sma_dbs`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

CREATE TABLE `sma_multi_company` (
  `id` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  `slug` varchar(255) NOT NULL,
  `db_id` int(11) NOT NULL,
  `owner_id` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

ALTER TABLE `sma_multi_company`
  ADD PRIMARY KEY (`id`);

ALTER TABLE `sma_multi_company`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

# Create New Table for Accounts 

CREATE TABLE `sma_accounts_ledgers_cats` (`id` INT NOT NULL AUTO_INCREMENT , `name` VARCHAR(255) NOT NULL , PRIMARY KEY (`id`)) ENGINE = InnoDB;


ALTER TABLE `sma_warehouses` ADD `goods_in_transit` TINYINT(1) NOT NULL DEFAULT '0' AFTER `vat_on_sales_ledger`;

ALTER TABLE `sma_accounts_entries` ADD `tid` INT NOT NULL AFTER `rid`;



# Add expiry
ALTER TABLE `sma_warehouses_products` ADD `batchno` VARCHAR(50) NOT NULL AFTER `avg_cost`;

ALTER TABLE `sma_warehouses_products` ADD `expiry` DATE NULL DEFAULT NULL AFTER `batchno`;




